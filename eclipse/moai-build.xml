<?xml version="1.0" encoding="UTF-8"?>
<project name="pack-lua" default="os-selector">

	<taskdef resource="net/sf/antcontrib/antcontrib.properties"/>

    <!-- ================================================================ -->
    <!-- os-selector -->
    <!-- ================================================================ -->	
	<target name="os-selector">
		
		<condition property="isWindows">
			<os family="windows"/>
		</condition>
		
		<condition property="isOsx">
			<os family="unix"/>
		</condition>

		<antcall target="build-libmoai-osx"/>
		<antcall target="build-libmoai-windows"/>

		<antcall target="pack-osx"/>
		<antcall target="pack-windows"/>
	</target>

    <!-- ================================================================ -->
    <!-- build-libmoai-osx -->
    <!-- ================================================================ -->
	<target name="build-libmoai-osx" if="isOsx">
		
		<exec executable="bash" dir="libmoai">
			<arg line="build-osx.sh"/>
		</exec>
	</target>
	
    <!-- ================================================================ -->
    <!-- build-libmoai-windows -->
    <!-- ================================================================ -->
	<target name="build-libmoai-windows" if="isWindows">

		<exec executable="cmd" dir="libmoai">
		    <arg value="/c"/>
		    <arg value="build-windows.bat false"/>
		    <arg value="-p"/>
		</exec>
	</target>
	
    <!-- ================================================================ -->
    <!-- pack-osx -->
    <!-- ================================================================ -->	
	<target name="pack-osx" if="isOsx">
		
		<exec executable="bash">
			<arg line="pack-lua.sh"/>
		</exec>
	</target>

    <!-- ================================================================ -->
    <!-- pack-windows -->
    <!-- ================================================================ -->	
	<target name="pack-windows" if="isWindows">

		<exec executable="cmd">
		    <arg value="/c"/>
		    <arg value="pack-lua.bat"/>
		    <arg value="-p"/>
		</exec>
	</target>
	
</project>